import{J as P,f as k,p as m,aa as b,r as E,ab as T,g as f,o as p,F as V,a as A,n as N}from"./index-C2TftA0i.js";const q={class:"w-full h-full"},B=["src"],D=["poster"],F=["src"],H={__name:"VideoPlayer",props:{src:{type:String,required:!0},title:{type:String,default:"Video"},poster:{type:String,default:""},storageKey:{type:String,default:""}},setup(_){const g=_,v=E(!1),n=m(()=>g.src||""),h=m(()=>{const l=n.value||"";return l.includes("youtube.com")||l.includes("youtu.be")}),w=m(()=>{const o=(n.value||"").match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\s]+)/);return o?`https://www.youtube.com/embed/${o[1]}?rel=0&modestbranding=1`:""}),e=E(null);let t=null,a=null,y=null;function S(){const l=g.storageKey||n.value;return l?`pfspace:progress:${l}`:null}return k(async()=>{if(!h.value)try{const[{default:l},o]=await Promise.all([b(()=>import("./plyr-Cwtstkjp.js"),[]),b(()=>import("./hls-DuDM7LWb.js"),[])]),c=n.value;if(/\.m3u8($|\\?)/i.test(c))if(o.default.isSupported())t=new o.default,t.loadSource(c),t.attachMedia(e.value),t.on(o.default.Events.MANIFEST_PARSED,()=>{const u=t.levels.map(r=>r.height),s=[0,...u];a.config.quality={default:0,options:s,forced:!0,onChange:r=>{r===0?t.currentLevel=-1:t.levels.forEach((I,L)=>{I.height===r&&(t.currentLevel=L)})}},a.config.i18n.quality="Kualitas";const d={0:"Auto"};u.forEach(r=>{d[r]=`${r}p`}),a.config.displayDuration=!0});else if(e.value.canPlayType("application/vnd.apple.mpegurl"))e.value.src=c;else{v.value=!0;return}else e.value.src=c;a=new l(e.value,{controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],invertTime:!1,speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2]},quality:{default:0,options:[0]}});const i=S();if(i){const u=localStorage.getItem(i),s=u?parseFloat(u):0;if(!isNaN(s)&&s>5){const d=()=>{e.value&&e.value.duration&&s<e.value.duration-5&&(e.value.currentTime=s),e.value.removeEventListener("loadedmetadata",d)};e.value.addEventListener("loadedmetadata",d)}y=setInterval(()=>{!e.value||e.value.paused||localStorage.setItem(i,String(e.value.currentTime||0))},5e3),e.value.addEventListener("ended",()=>{localStorage.removeItem(i)})}if(e.value&&e.value.controlsList)try{e.value.controlsList.add("nodownload")}catch{}}catch(l){console.error("Init Plyr/HLS failed:",l),v.value=!0}}),T(()=>{try{a&&typeof a.destroy=="function"&&a.destroy(),t&&typeof t.destroy=="function"&&t.destroy(),y&&clearInterval(y)}catch{}}),(l,o)=>(p(),f("div",q,[h.value?(p(),f("iframe",{key:0,src:w.value,class:"w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",allowfullscreen:""},null,8,B)):(p(),f(V,{key:1},[A("video",{ref_key:"videoEl",ref:e,poster:_.poster||null,playsinline:"",controls:"",class:"w-full h-full bg-black object-contain"},null,8,D),v.value?(p(),f("video",{key:0,src:n.value||null,controls:"",class:"hidden"},null,8,F)):N("",!0)],64))]))}},x=P(H,[["__scopeId","data-v-e3e675f6"]]);export{x as V};
