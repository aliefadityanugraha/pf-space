import{e as le,f as ne,g as r,a as s,n as p,h as n,aO as oe,w as u,B as b,k as a,A,F as y,q as D,S as ie,r as g,l as re,aK as de,a8 as R,aL as ue,z as ce,L as q,C as c,E as f,ao as ve,Q as pe,G as be,X as S,D as F,ak as E,c as m,aq as Q,an as me,m as X,R as ge,a2 as W,aP as fe,H as ke,a7 as xe,t as T,o as l,ap as ye,O as _e}from"./index-Co7LmOIS.js";import{I as Y}from"./image-vsr9RIVc.js";import{C as he}from"./clock-C8NexgE6.js";import{F as we}from"./funnel-DvhUep-1.js";const je=le("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),Ce={class:"p-4 md:p-8"},$e={class:"flex items-center gap-2 text-xs font-mono uppercase tracking-wider mb-4"},Be={class:"flex flex-col md:flex-row gap-4 mb-6"},Ae={class:"flex gap-2"},Se={class:"relative flex-1 max-w-sm"},Te={class:"flex items-center gap-3"},ze={key:0,class:"flex items-center justify-center py-12"},Me={key:1,class:"text-center py-12 text-stone-400"},Le={class:"lg:col-span-4 flex items-center gap-3"},Pe=["src","alt"],Ve={key:1,class:"w-12 h-16 bg-stone-200 flex items-center justify-center rounded"},De={class:"min-w-0"},Fe={class:"block font-bold text-stone-900 truncate"},He={class:"text-xs text-stone-500 truncate"},Ne={class:"lg:col-span-2 text-sm text-stone-600"},Ue={class:"lg:col-span-2"},Ge={class:"lg:col-span-1 text-sm text-stone-600"},Ie={class:"lg:col-span-1 flex flex-col gap-1"},Re={class:"lg:col-span-2 flex gap-2 lg:justify-end"},qe={key:3,class:"flex flex-col sm:flex-row items-center justify-between gap-4 px-6 py-4 border-t border-stone-200"},Ee={class:"text-sm text-stone-600"},Je={class:"flex items-center gap-2"},Oe={class:"flex gap-1"},Qe={key:1,class:"flex items-center justify-center w-8 h-8 text-stone-400"},Xe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},We={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-2xl max-h-[90vh] overflow-y-auto"},Ye={class:"flex items-center justify-between px-6 py-4 border-b-2 border-black bg-stone-100 sticky top-0"},Ze={class:"p-6 space-y-4"},Ke={class:"flex gap-4"},es=["src","alt"],ss={class:"flex-1"},ts={class:"font-bold text-xl"},as={class:"text-stone-600 mt-1"},ls={class:"text-sm text-stone-600 mt-2"},ns={class:"text-sm text-stone-600"},os={class:"text-stone-600 text-sm"},is={class:"grid grid-cols-2 gap-4"},rs={key:0},ds=["href"],us={key:1},cs=["href"],vs={key:0},ps={class:"grid grid-cols-2 gap-2"},bs={class:"font-medium"},ms={class:"text-stone-600"},gs={key:1,class:"flex gap-3 pt-4 border-t"},fs={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},ks={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-sm mx-4"},xs={class:"font-bold text-lg"},ys={class:"p-6"},_s={class:"text-stone-600 mb-6"},hs={key:0,class:"mb-6"},ws={class:"flex gap-3"},js={key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Cs={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-lg"},$s={class:"flex items-center justify-between px-6 py-4 border-b-2 border-black bg-stone-100"},Bs={class:"p-6"},As={class:"mb-6"},Ss={class:"flex items-center gap-2 cursor-pointer"},Ts={class:"mb-6"},zs={key:0,class:"relative aspect-video bg-stone-100 mb-2 rounded overflow-hidden border border-stone-200"},Ms=["src"],Ls={key:1,class:"p-8 border-2 border-dashed border-stone-300 rounded text-center bg-stone-50"},Ps={class:"flex justify-end gap-3"},Us={__name:"Archives",setup(Vs){const H=g([]),N=g(!0),o=g({page:1,limit:10,total:0,totalPages:0}),z=g("all"),M=g(""),j=g(!1),C=g(!1),i=g(null),v=g({type:"",karya:null}),_=g(!1),$=g(""),h=g(!1),U=g(null),L=g(!1),P=g(!1),Z=d=>{i.value=d,L.value=!!d.is_banner_active,U.value=d.banner_url||null,h.value=!0},K=async()=>{if(i.value){P.value=!0;try{await T.put(`/api/films/${i.value.film_id}`,{is_banner_active:L.value}),k("success","Pengaturan banner berhasil disimpan"),h.value=!1,w()}catch(d){console.error("Failed to update banner:",d),k("error","Gagal menyimpan pengaturan banner")}finally{P.value=!1}}},{toast:V,showToast:k}=ke(),J={pending:"bg-yellow-100 text-yellow-800 border-yellow-300",published:"bg-green-100 text-green-800 border-green-300",rejected:"bg-red-100 text-red-800 border-red-300"},G={pending:"Menunggu",published:"Dipublikasi",rejected:"Ditolak"},w=async()=>{N.value=!0;try{let d="/api/films";const e=new URLSearchParams;e.append("page",o.value.page),e.append("limit",o.value.limit),M.value&&e.append("search",M.value),z.value!=="all"&&e.append("status",z.value);const t=await T.get(`${d}?${e}`);H.value=t.data,t.pagination&&(o.value={...o.value,...t.pagination})}catch(d){console.error("Failed to fetch archives:",d),k("error","Gagal memuat data arsip")}finally{N.value=!1}},ee=d=>{i.value=d,j.value=!0},B=(d,e)=>{v.value={type:d,karya:e},d==="reject"&&($.value=""),C.value=!0},se=async()=>{const{type:d,karya:e}=v.value;_.value=!0;try{if(d==="approve")await T.patch(`/api/films/${e.film_id}/approve`,{}),k("success",`Karya "${e.judul}" berhasil dipublikasi`);else if(d==="reject"){if(!$.value.trim()){k("error","Alasan penolakan wajib diisi"),_.value=!1;return}await T.patch(`/api/films/${e.film_id}/reject`,{rejection_reason:$.value.trim()}),k("success",`Karya "${e.judul}" ditolak`)}else d==="delete"&&(await T.delete(`/api/films/${e.film_id}`),k("success",`Karya "${e.judul}" berhasil dihapus`));C.value=!1,j.value=!1,await w()}catch(t){k("error",t.message||"Gagal melakukan aksi")}finally{_.value=!1}};let O;const te=()=>{clearTimeout(O),O=setTimeout(()=>{o.value.page=1,w()},300)},I=d=>{d>=1&&d<=o.value.totalPages&&(o.value.page=d,w())},ae=d=>{z.value=d,o.value.page=1,w()};return ne(w),(d,e)=>(l(),r(y,null,[s("main",Ce,[s("nav",$e,[e[16]||(e[16]=s("a",{href:"/",class:"text-brand-teal hover:underline"},"Beranda",-1)),e[17]||(e[17]=s("span",{class:"text-stone-400"},"/",-1)),e[18]||(e[18]=s("span",{class:"text-stone-600"},"Administrasi",-1)),e[19]||(e[19]=s("span",{class:"text-stone-400"},"/",-1)),n(a(A),{variant:"outline",class:"bg-orange-100 text-orange-700 border-orange-300"},{default:u(()=>[...e[15]||(e[15]=[b("Arsip",-1)])]),_:1})]),e[25]||(e[25]=oe('<div class="flex flex-col xl:flex-row xl:items-center xl:justify-between gap-4 mb-8"><div class="flex items-start gap-4"><div class="w-1 h-20 bg-teal-500 rounded-full"></div><div><h1 class="font-display text-4xl text-stone-900">Manajemen Arsip</h1><p class="text-stone-600 mt-2 max-w-xl">Kelola dan moderasi karya yang diunggah creator.</p></div></div></div>',1)),s("div",Be,[s("div",Ae,[(l(),r(y,null,D(["all","pending","published","rejected"],t=>n(a(f),{key:t,variant:z.value===t?"default":"outline",size:"sm",onClick:x=>ae(t),class:"gap-2"},{default:u(()=>[t==="pending"?(l(),m(a(he),{key:0,class:"w-4 h-4"})):t==="published"?(l(),m(a(Q),{key:1,class:"w-4 h-4"})):t==="rejected"?(l(),m(a(ye),{key:2,class:"w-4 h-4"})):(l(),m(a(we),{key:3,class:"w-4 h-4"})),b(" "+c(t==="all"?"Semua":G[t]),1)]),_:2},1032,["variant","onClick"])),64))]),s("div",Se,[n(a(ie),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"}),n(a(re),{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=t=>M.value=t),onInput:te,placeholder:"Cari judul...",class:"pl-10"},null,8,["modelValue"])])]),n(a(be),{class:"w-full"},{default:u(()=>[n(a(de),{class:"bg-teal-50 border-b-2 border-stone-800"},{default:u(()=>[s("div",Te,[n(a(R),{class:"w-5 h-5"}),n(a(ue),{class:"text-lg font-bold uppercase"},{default:u(()=>[...e[20]||(e[20]=[b("Daftar Arsip Karya",-1)])]),_:1})])]),_:1}),n(a(ce),{class:"p-0"},{default:u(()=>[N.value?(l(),r("div",ze,[n(a(q),{class:"w-8 h-8 animate-spin text-stone-400"})])):H.value.length===0?(l(),r("div",Me,[n(a(R),{class:"w-12 h-12 mx-auto mb-2 opacity-50"}),e[21]||(e[21]=s("p",{class:"mb-1"},"Tidak ada karya yang cocok dengan filter saat ini.",-1)),e[22]||(e[22]=s("p",{class:"text-sm"}," Coba ubah status, kata kunci pencarian, atau reset filter yang aktif. ",-1))])):(l(),r(y,{key:2},[e[24]||(e[24]=s("div",{class:"hidden lg:grid grid-cols-12 gap-4 px-6 py-3 bg-lime-50 border-b-2 border-stone-800 text-xs font-bold uppercase tracking-wider"},[s("div",{class:"col-span-4"},"Karya"),s("div",{class:"col-span-2"},"Creator"),s("div",{class:"col-span-2"},"Kategori"),s("div",{class:"col-span-1"},"Tahun"),s("div",{class:"col-span-1"},"Status"),s("div",{class:"col-span-2 text-right"},"Aksi")],-1)),(l(!0),r(y,null,D(H.value,t=>(l(),r("div",{key:t.film_id,class:"grid grid-cols-1 lg:grid-cols-12 gap-4 px-6 py-4 items-center border-b border-stone-200 hover:bg-stone-50 w-full"},[s("div",Le,[t.gambar_poster?(l(),r("img",{key:0,src:t.gambar_poster,alt:t.judul,class:"w-12 h-16 object-cover border border-stone-200 rounded"},null,8,Pe)):(l(),r("div",Ve,[n(a(R),{class:"w-6 h-6 text-stone-400"})])),s("div",De,[s("span",Fe,c(t.judul),1),s("p",He,c(t.sinopsis||"-"),1)])]),s("div",Ne,c(t.creator?.name||"-"),1),s("div",Ue,[n(a(A),{variant:"secondary"},{default:u(()=>[b(c(t.category?.nama_kategori||"-"),1)]),_:2},1024)]),s("div",Ge,c(t.tahun_karya||"-"),1),s("div",Ie,[n(a(A),{class:F(J[t.status])},{default:u(()=>[b(c(G[t.status]),1)]),_:2},1032,["class"]),t.is_banner_active?(l(),m(a(A),{key:0,class:"bg-blue-100 text-blue-800 border-blue-300 w-fit"},{default:u(()=>[n(a(je),{class:"w-3 h-3 mr-1"}),e[23]||(e[23]=b(" Banner ",-1))]),_:1})):p("",!0)]),s("div",Re,[n(a(f),{variant:"outline",size:"sm",onClick:x=>ee(t),title:"Lihat Detail"},{default:u(()=>[n(a(_e),{class:"w-4 h-4"})]),_:1},8,["onClick"]),t.status==="published"?(l(),m(a(f),{key:0,variant:"outline",size:"sm",class:"text-blue-600 hover:bg-blue-50",onClick:x=>Z(t),title:"Atur Banner"},{default:u(()=>[n(a(Y),{class:"w-4 h-4"})]),_:1},8,["onClick"])):p("",!0),t.status==="pending"?(l(),m(a(f),{key:1,variant:"outline",size:"sm",class:"text-green-600 hover:bg-green-50",onClick:x=>B("approve",t),title:"Setujui"},{default:u(()=>[n(a(E),{class:"w-4 h-4"})]),_:1},8,["onClick"])):p("",!0),t.status==="pending"?(l(),m(a(f),{key:2,variant:"outline",size:"sm",class:"text-red-600 hover:bg-red-50",onClick:x=>B("reject",t),title:"Tolak"},{default:u(()=>[n(a(S),{class:"w-4 h-4"})]),_:1},8,["onClick"])):p("",!0),n(a(f),{variant:"outline",size:"sm",class:"text-red-600 hover:bg-red-50",onClick:x=>B("delete",t),title:"Hapus"},{default:u(()=>[n(a(W),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128))],64)),o.value.totalPages>1?(l(),r("div",qe,[s("span",Ee," Menampilkan "+c((o.value.page-1)*o.value.limit+1)+" - "+c(Math.min(o.value.page*o.value.limit,o.value.total))+" dari "+c(o.value.total)+" karya ",1),s("div",Je,[n(a(f),{variant:"outline",size:"sm",disabled:o.value.page<=1,onClick:e[1]||(e[1]=t=>I(o.value.page-1)),title:"Sebelumnya"},{default:u(()=>[n(a(ve),{class:"w-4 h-4"})]),_:1},8,["disabled"]),s("div",Oe,[(l(!0),r(y,null,D(o.value.totalPages,t=>(l(),r(y,{key:t},[t===1||t===o.value.totalPages||t>=o.value.page-1&&t<=o.value.page+1?(l(),m(a(f),{key:0,variant:o.value.page===t?"default":"outline",size:"sm",class:"w-8 h-8 p-0",onClick:x=>I(t)},{default:u(()=>[b(c(t),1)]),_:2},1032,["variant","onClick"])):t===o.value.page-2||t===o.value.page+2?(l(),r("span",Qe," ... ")):p("",!0)],64))),128))]),n(a(f),{variant:"outline",size:"sm",disabled:o.value.page>=o.value.totalPages,onClick:e[2]||(e[2]=t=>I(o.value.page+1)),title:"Selanjutnya"},{default:u(()=>[n(a(pe),{class:"w-4 h-4"})]),_:1},8,["disabled"])])])):p("",!0)]),_:1})]),_:1})]),j.value&&i.value?(l(),r("div",Xe,[s("div",{class:"absolute inset-0 bg-black/50",onClick:e[3]||(e[3]=t=>j.value=!1)}),s("div",We,[s("div",Ye,[e[26]||(e[26]=s("h2",{class:"font-bold text-lg"},"Detail Arsip Karya",-1)),s("button",{onClick:e[4]||(e[4]=t=>j.value=!1),class:"p-1 hover:bg-stone-200"},[n(a(S),{class:"w-5 h-5"})])]),s("div",Ze,[s("div",Ke,[i.value.gambar_poster?(l(),r("img",{key:0,src:i.value.gambar_poster,alt:i.value.judul,class:"w-32 h-44 object-cover border-2 border-black"},null,8,es)):p("",!0),s("div",ss,[s("h3",ts,c(i.value.judul),1),s("p",as,c(i.value.tahun_karya),1),n(a(A),{class:F([J[i.value.status],"mt-2"])},{default:u(()=>[b(c(G[i.value.status]),1)]),_:1},8,["class"]),s("p",ls,[e[27]||(e[27]=s("span",{class:"font-medium"},"Creator:",-1)),b(" "+c(i.value.creator?.name),1)]),s("p",ns,[e[28]||(e[28]=s("span",{class:"font-medium"},"Kategori:",-1)),b(" "+c(i.value.category?.nama_kategori),1)])])]),s("div",null,[e[29]||(e[29]=s("h4",{class:"font-bold text-sm uppercase mb-2"},"Sinopsis",-1)),s("p",os,c(i.value.sinopsis||"-"),1)]),s("div",is,[i.value.link_video_utama?(l(),r("div",rs,[e[30]||(e[30]=s("h4",{class:"font-bold text-sm uppercase mb-1"},"Video Utama",-1)),s("a",{href:i.value.link_video_utama,target:"_blank",class:"text-teal-600 hover:underline text-sm truncate block"},c(i.value.link_video_utama),9,ds)])):p("",!0),i.value.link_trailer?(l(),r("div",us,[e[31]||(e[31]=s("h4",{class:"font-bold text-sm uppercase mb-1"},"Trailer",-1)),s("a",{href:i.value.link_trailer,target:"_blank",class:"text-teal-600 hover:underline text-sm truncate block"},c(i.value.link_trailer),9,cs)])):p("",!0)]),i.value.crew&&i.value.crew.length?(l(),r("div",vs,[e[32]||(e[32]=s("h4",{class:"font-bold text-sm uppercase mb-2"},"Crew",-1)),s("div",ps,[(l(!0),r(y,null,D(i.value.crew,(t,x)=>(l(),r("div",{key:x,class:"text-sm"},[s("span",bs,c(t.jabatan)+":",1),s("span",ms,c(t.anggota?.join(", ")),1)]))),128))])])):p("",!0),i.value.status==="pending"?(l(),r("div",gs,[n(a(f),{class:"flex-1 gap-2 bg-green-600 hover:bg-green-700",onClick:e[5]||(e[5]=t=>B("approve",i.value))},{default:u(()=>[n(a(E),{class:"w-4 h-4"}),e[33]||(e[33]=b(" Setujui ",-1))]),_:1}),n(a(f),{variant:"outline",class:"flex-1 gap-2 text-red-600",onClick:e[6]||(e[6]=t=>B("reject",i.value))},{default:u(()=>[n(a(S),{class:"w-4 h-4"}),e[34]||(e[34]=b(" Tolak ",-1))]),_:1})])):p("",!0)])])])):p("",!0),C.value?(l(),r("div",fs,[s("div",{class:"absolute inset-0 bg-black/50",onClick:e[7]||(e[7]=t=>C.value=!1)}),s("div",ks,[s("div",{class:F(["flex items-center gap-3 px-6 py-4 border-b-2 border-black",v.value.type==="approve"?"bg-green-50":"bg-red-50"])},[v.value.type==="approve"?(l(),m(a(Q),{key:0,class:"w-5 h-5 text-green-600"})):(l(),m(a(me),{key:1,class:"w-5 h-5 text-red-600"})),s("h2",xs,c(v.value.type==="approve"?"Setujui Karya":v.value.type==="reject"?"Tolak Karya":"Hapus Karya"),1)],2),s("div",ys,[s("p",_s,c(v.value.type==="approve"?`Approve dan publikasikan karya "${v.value.karya?.judul}"?`:v.value.type==="reject"?`Tolak karya "${v.value.karya?.judul}"?`:`Hapus karya "${v.value.karya?.judul}"? Aksi ini tidak dapat dibatalkan.`),1),v.value.type==="reject"?(l(),r("div",hs,[e[35]||(e[35]=s("label",{class:"block text-sm font-medium text-stone-700 mb-2"}," Alasan penolakan untuk kreator ",-1)),X(s("textarea",{"onUpdate:modelValue":e[8]||(e[8]=t=>$.value=t),rows:"3",class:"w-full border-2 border-stone-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-red-300 focus:border-red-400 resize-none",placeholder:"Contoh: Kualitas audio kurang jelas, mohon perbaiki mixing dan kirim ulang."},null,512),[[ge,$.value]])])):p("",!0),s("div",ws,[n(a(f),{type:"button",variant:"outline",class:"flex-1",onClick:e[9]||(e[9]=t=>C.value=!1),disabled:_.value},{default:u(()=>[...e[36]||(e[36]=[b(" Batal ",-1)])]),_:1},8,["disabled"]),n(a(f),{type:"button",class:F(["flex-1 gap-2",v.value.type==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"]),onClick:se,disabled:_.value},{default:u(()=>[_.value?(l(),m(a(q),{key:0,class:"w-4 h-4 animate-spin"})):v.value.type==="approve"?(l(),m(a(E),{key:1,class:"w-4 h-4"})):v.value.type==="reject"?(l(),m(a(S),{key:2,class:"w-4 h-4"})):(l(),m(a(W),{key:3,class:"w-4 h-4"})),b(" "+c(v.value.type==="approve"?"Setujui":v.value.type==="reject"?"Tolak":"Hapus"),1)]),_:1},8,["class","disabled"])])])])])):p("",!0),h.value?(l(),r("div",js,[s("div",{class:"absolute inset-0 bg-black/50",onClick:e[10]||(e[10]=t=>h.value=!1)}),s("div",Cs,[s("div",$s,[e[37]||(e[37]=s("h2",{class:"font-bold text-lg"},"Pengaturan Banner",-1)),s("button",{onClick:e[11]||(e[11]=t=>h.value=!1),class:"p-1 hover:bg-stone-200 rounded"},[n(a(S),{class:"w-5 h-5"})])]),s("div",Bs,[s("div",As,[s("label",Ss,[X(s("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=t=>L.value=t),class:"w-4 h-4 rounded border-stone-300 text-brand-teal focus:ring-brand-teal"},null,512),[[fe,L.value]]),e[38]||(e[38]=s("span",{class:"font-bold text-stone-700"},"Tampilkan sebagai Banner Carousel",-1))]),e[39]||(e[39]=s("p",{class:"text-xs text-stone-500 mt-1 ml-6"}," Jika aktif, Film ini akan muncul di slider halaman utama. ",-1))]),s("div",Ts,[e[42]||(e[42]=s("label",{class:"block text-sm font-bold text-stone-700 mb-2"}," Preview Banner ",-1)),U.value?(l(),r("div",zs,[s("img",{src:U.value,class:"w-full h-full object-cover"},null,8,Ms)])):(l(),r("div",Ls,[n(a(Y),{class:"w-12 h-12 mx-auto text-stone-300 mb-2"}),e[40]||(e[40]=s("p",{class:"text-stone-500 font-bold"},"Creator belum mengupload gambar banner.",-1)),e[41]||(e[41]=s("p",{class:"text-xs text-stone-400 mt-1"},"Jika diaktifkan, sistem akan menggunakan gambar poster sebagai fallback.",-1))]))]),s("div",Ps,[n(a(f),{variant:"outline",onClick:e[13]||(e[13]=t=>h.value=!1)},{default:u(()=>[...e[43]||(e[43]=[b("Batal",-1)])]),_:1}),n(a(f),{onClick:K,disabled:P.value},{default:u(()=>[P.value?(l(),m(a(q),{key:0,class:"w-4 h-4 animate-spin mr-2"})):p("",!0),e[44]||(e[44]=b(" Simpan ",-1))]),_:1},8,["disabled"])])])])])):p("",!0),n(xe,{show:a(V).show,type:a(V).type,message:a(V).message,onClose:e[14]||(e[14]=t=>a(V).show=!1)},null,8,["show","type","message"])],64))}};export{Us as default};
