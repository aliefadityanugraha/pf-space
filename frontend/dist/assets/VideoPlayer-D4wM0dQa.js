import{J as P,f as L,al as h,p as _,r as k,am as x,g as u,o as c,n as V}from"./index-Co7LmOIS.js";const q={class:"w-full h-full bg-black"},H=["data-plyr-embed-id"],A=["poster"],C={key:2,class:"absolute inset-0 flex items-center justify-center text-white/40 text-xs uppercase font-black tracking-widest bg-stone-900"},D={__name:"VideoPlayer",props:{src:{type:String,required:!0},title:{type:String,default:"Video"},poster:{type:String,default:""},storageKey:{type:String,default:""}},setup(g,{expose:E}){const b=g,d=k(!1),n=_(()=>b.src||""),p=_(()=>{const t=n.value||"";return t.includes("youtube.com")||t.includes("youtu.be")}),S=_(()=>{const t=n.value||"",r=t.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\s]+)/);return r?r[1]:t}),l=k(null);let o=null,e=null,f=null;function T(){const t=b.storageKey||n.value;return t?`pfspace:progress:${t}`:null}return L(async()=>{try{const[{default:t},r]=await Promise.all([h(()=>import("./plyr-Cwtstkjp.js"),[]),h(()=>import("./hls-DuDM7LWb.js"),[])]),v=r.default||r;if(p.value){e=new t(l.value,{controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],youtube:{noCookie:!0,rel:0,showinfo:0,iv_load_policy:3,modestbranding:1}});return}const i=n.value;if(/\.m3u8($|\\?)/i.test(i))if(v.isSupported())o=new v,o.loadSource(i),o.attachMedia(l.value),o.on(v.Events.MANIFEST_PARSED,()=>{const s=[0,...o.levels.map(a=>a.height)];e.config.quality={default:0,options:s,forced:!0,onChange:a=>{a===0?o.currentLevel=-1:o.levels.forEach((w,I)=>{w.height===a&&(o.currentLevel=I)})}},e.config.i18n.quality="Kualitas",e.config.displayDuration=!0});else if(l.value.canPlayType("application/vnd.apple.mpegurl"))l.value.src=i;else{d.value=!0;return}else l.value.src=i||"";e=new t(l.value,{controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],invertTime:!1,speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2]},quality:{default:0,options:[0]}});const y=T();if(y){const m=localStorage.getItem(y),s=m?parseFloat(m):0;if(!isNaN(s)&&s>5){const a=()=>{e&&e.duration&&s<e.duration-5&&(e.currentTime=s),l.value.removeEventListener("loadedmetadata",a)};l.value.addEventListener("loadedmetadata",a)}f=setInterval(()=>{!e||e.paused||localStorage.setItem(y,String(e.currentTime||0))},5e3)}if(l.value&&l.value.controlsList)try{l.value.controlsList.add("nodownload")}catch{}}catch(t){console.error("Init Plyr/HLS failed:",t),d.value=!0}}),x(()=>{try{e&&typeof e.destroy=="function"&&e.destroy(),o&&typeof o.destroy=="function"&&o.destroy(),f&&clearInterval(f)}catch{}}),E({getCurrentTime:()=>e?e.currentTime:0,seekTo:t=>{e&&(e.currentTime=t,e.play())}}),(t,r)=>(c(),u("div",q,[p.value?(c(),u("div",{key:0,ref_key:"videoEl",ref:l,"data-plyr-provider":"youtube","data-plyr-embed-id":S.value},null,8,H)):(c(),u("video",{key:1,ref_key:"videoEl",ref:l,poster:g.poster||null,playsinline:"",controls:"",class:"w-full h-full bg-black object-contain"},null,8,A)),d.value&&!p.value?(c(),u("div",C," Gagal memuat video ")):V("",!0)]))}},N=P(D,[["__scopeId","data-v-8886cd5b"]]);export{N as V};
