import{_ as E}from"./PageHeader-DFUzlPy8.js";import{as as F,g as u,D as h,k as t,aS as K,$ as N,o,f as U,a as s,h as a,n as D,w as l,B as r,a0 as G,A as T,aT as q,aK as C,aG as H,aL as j,E as p,r as g,z as $,L as A,F as J,q as P,G as B,an as R,a2 as S,X,c as x,t as M,C as v,U as Y,a8 as Z,H as I}from"./index-Co7LmOIS.js";import{R as O}from"./refresh-cw-NC5O2nye.js";const V=F({__name:"CardDescription",props:{class:{}},setup(w){const m=w;return(i,c)=>(o(),u("p",{class:h(t(K)("text-sm text-stone-600 font-body",m.class))},[N(i.$slots,"default")],2))}}),Q={class:"p-4 md:p-8"},W={class:"flex items-center gap-2 text-xs font-mono uppercase tracking-wider mb-4"},ee={class:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8"},se={class:"flex items-center justify-between"},te={class:"flex items-center gap-2"},ae={key:0,class:"p-8 flex justify-center"},ne={key:1,class:"p-8 text-center text-stone-500 italic"},le={key:2,class:"divide-y divide-stone-200"},re={class:"w-10 h-14 bg-stone-200 border border-stone-800 flex-shrink-0 overflow-hidden"},oe=["src"],ie={class:"flex-1 min-w-0"},de={class:"font-bold text-sm truncate"},ue={class:"text-xs text-stone-500"},ce={class:"flex items-center gap-2 text-red-700"},be={class:"flex flex-col gap-4"},fe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},me={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-md animate-in fade-in zoom-in duration-200"},pe={class:"flex items-center justify-between px-6 py-4 border-b-2 border-black bg-red-50"},ge={class:"flex items-center gap-2 text-red-700"},ve=["disabled"],_e={class:"p-6"},xe={class:"flex gap-3 justify-end"},ye={__name:"TrendingManager",setup(w){const{showToast:m}=I(),i=g(!1),c=g([]),f=g(!0),b=g(!1),_=async()=>{f.value=!0;try{const n=await M.get("/api/votes/trending",{params:{limit:10,period:"all"}});Array.isArray(n)?c.value=n:(n?.data&&Array.isArray(n.data)||n?.success&&Array.isArray(n.data))&&(c.value=n.data)}catch(n){console.error("Failed to fetch trending:",n)}finally{f.value=!1}},z=()=>{b.value=!0},L=async()=>{i.value=!0;try{const n=await M.delete("/api/votes/reset");if(n?.success||n?.message?.toLowerCase().includes("success"))m("Semua voting telah direset."),b.value=!1,await _();else throw new Error(n?.message||"Gagal mereset voting")}catch(n){console.error("Reset votes error:",n);const e=n.message||"Terjadi kesalahan saat mereset voting.";m(e,"error")}finally{i.value=!1}};return U(()=>{_()}),(n,e)=>{const k=G("router-link");return o(),u("div",Q,[s("nav",W,[a(k,{to:"/",class:"text-brand-teal hover:underline"},{default:l(()=>[...e[3]||(e[3]=[r("Beranda",-1)])]),_:1}),e[6]||(e[6]=s("span",{class:"text-stone-400"},"/",-1)),a(k,{to:"/admin",class:"text-stone-600 hover:underline"},{default:l(()=>[...e[4]||(e[4]=[r("Administrasi",-1)])]),_:1}),e[7]||(e[7]=s("span",{class:"text-stone-400"},"/",-1)),a(t(T),{variant:"outline",class:"bg-blue-100 text-blue-700 border-blue-300"},{default:l(()=>[...e[5]||(e[5]=[r("Manajer Trending",-1)])]),_:1})]),a(E,{title:"Manajemen Trending",description:"Kelola sistem trending dan reset status apresiasi karya.",icon:t(q),"icon-color":"bg-blue-500"},null,8,["icon"]),s("div",ee,[a(t(B),{class:"border-2 border-black shadow-brutal h-fit"},{default:l(()=>[a(t(C),{class:"bg-stone-50 border-b-2 border-black"},{default:l(()=>[s("div",se,[s("div",te,[a(t(H),{class:"w-5 h-5"}),a(t(j),null,{default:l(()=>[...e[8]||(e[8]=[r("Status Peringkat Trending",-1)])]),_:1})]),a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-8 hover:bg-stone-200",onClick:_,disabled:f.value},{default:l(()=>[a(t(O),{class:h(["w-4 h-4",{"animate-spin":f.value}])},null,8,["class"])]),_:1},8,["disabled"])]),a(t(V),null,{default:l(()=>[...e[9]||(e[9]=[r(" Top 10 karya dengan apresiasi terbanyak saat ini. ",-1)])]),_:1})]),_:1}),a(t($),{class:"p-0"},{default:l(()=>[f.value?(o(),u("div",ae,[a(t(A),{class:"w-8 h-8 animate-spin text-stone-400"})])):c.value.length===0?(o(),u("div",ne," Belum ada data trending. ")):(o(),u("div",le,[(o(!0),u(J,null,P(c.value,(d,y)=>(o(),u("div",{key:d.film_id,class:"flex items-center gap-4 p-4 hover:bg-stone-50 transition-colors"},[s("div",{class:h(["w-8 h-8 flex items-center justify-center font-bold font-mono border-2 border-black shadow-brutal-sm",y<3?"bg-yellow-400":"bg-white"])}," #"+v(y+1),3),s("div",re,[d.gambar_poster?(o(),u("img",{key:0,src:t(Y)(d.gambar_poster),class:"w-full h-full object-cover"},null,8,oe)):(o(),x(t(Z),{key:1,class:"w-full h-full p-2 text-stone-400"}))]),s("div",ie,[s("h4",de,v(d.judul),1),s("p",ue,v(d.category?.nama_kategori||"-"),1)]),a(t(T),{variant:"secondary",class:"font-mono bg-stone-800 text-white border-none"},{default:l(()=>[r(v(d.vote_count)+" Suara ",1)]),_:2},1024)]))),128))]))]),_:1})]),_:1}),a(t(B),{class:"border-2 border-red-200 shadow-brutal h-fit"},{default:l(()=>[a(t(C),{class:"bg-red-50 border-b border-red-100"},{default:l(()=>[s("div",ce,[a(t(R),{class:"w-5 h-5"}),a(t(j),null,{default:l(()=>[...e[10]||(e[10]=[r("Zona Bahaya",-1)])]),_:1})]),a(t(V),{class:"text-red-600"},{default:l(()=>[...e[11]||(e[11]=[r(" Tindakan di bawah ini bersifat destruktif dan tidak dapat dibatalkan. ",-1)])]),_:1})]),_:1}),a(t($),{class:"p-6"},{default:l(()=>[s("div",be,[e[13]||(e[13]=s("div",null,[s("h3",{class:"font-bold text-stone-900 mb-1"},"Reset Statistik Trending"),s("p",{class:"text-sm text-stone-500"}," Menghapus seluruh data apresiasi dari database. Jumlah suara pada semua karya akan kembali menjadi 0. ")],-1)),a(t(p),{variant:"destructive",class:"w-full sm:w-auto bg-red-600 hover:bg-red-700 border-2 border-black shadow-brutal hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-brutal-sm transition-all justify-center",onClick:z,disabled:i.value},{default:l(()=>[a(t(S),{class:"w-4 h-4 mr-2"}),e[12]||(e[12]=r(" Reset Trending ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1})]),b.value?(o(),u("div",fe,[s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e[0]||(e[0]=d=>i.value?null:b.value=!1)}),s("div",me,[s("div",pe,[s("div",ge,[a(t(R),{class:"w-5 h-5"}),e[14]||(e[14]=s("h2",{class:"font-bold text-lg"},"Konfirmasi Reset",-1))]),s("button",{onClick:e[1]||(e[1]=d=>b.value=!1),class:"p-1 hover:bg-red-100 rounded transition-colors",disabled:i.value},[a(t(X),{class:"w-5 h-5"})],8,ve)]),s("div",_e,[e[17]||(e[17]=s("p",{class:"text-stone-700 mb-6 leading-relaxed"},[r(" Apakah Anda yakin ingin mereset "),s("strong",null,"SEMUA"),r(" data trending? "),s("br"),s("br"),s("span",{class:"text-red-600 font-bold text-sm bg-red-50 px-2 py-1 border border-red-200 rounded"}," Tindakan ini tidak dapat dibatalkan! ")],-1)),s("div",xe,[a(t(p),{type:"button",variant:"outline",onClick:e[2]||(e[2]=d=>b.value=!1),disabled:i.value},{default:l(()=>[...e[15]||(e[15]=[r(" Batal ",-1)])]),_:1},8,["disabled"]),a(t(p),{type:"button",class:"bg-red-600 hover:bg-red-700 text-white gap-2",onClick:L,disabled:i.value},{default:l(()=>[i.value?(o(),x(t(A),{key:0,class:"w-4 h-4 animate-spin"})):(o(),x(t(S),{key:1,class:"w-4 h-4"})),e[16]||(e[16]=r(" Ya, Reset Semua ",-1))]),_:1},8,["disabled"])])])])])):D("",!0)])}}};export{ye as default};
