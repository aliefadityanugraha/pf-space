import{y as E,f as C,g as n,h as t,a as e,i as F,w as P,k as s,E as S,r as o,L as D,F as $,n as b,ac as h,C as f,s as A,t as K,H as R,T,o as l}from"./index-CfAmW5bf.js";import{u as B,_ as L}from"./ArchiveUploadForm-CoQeVNyr.js";import{A as M}from"./arrow-left-BZuD_aTl.js";import"./index-BpHRcGa7.js";import"./circle-alert-18xIEM92.js";import"./plus-CfAW4Oo1.js";import"./save-DBt6nMDH.js";const N={class:"min-h-screen flex flex-col bg-brand-cream"},V={class:"w-full max-w-7xl mx-auto px-4 md:px-8 pt-28 pb-16"},G={class:"flex items-center gap-4 mb-8"},z={key:0,class:"flex items-center justify-center py-20"},H={key:0,class:"mb-6 p-4 bg-yellow-50 border-2 border-yellow-300 flex items-start gap-3"},I={class:"min-w-0"},J={class:"text-sm text-yellow-700"},Y={class:"mb-6 p-4 bg-stone-50 border-2 border-stone-300 rounded-lg flex gap-3"},q={class:"mt-1 shrink-0"},O={key:1,class:"mb-6 p-4 bg-red-50 border-2 border-red-200 text-red-600"},ia={__name:"EditArchive",setup(Q){const d=T(),g=E().params.slug,u=o(!0),r=o(""),m=o(null),c=o(null),{showToast:p}=R(),{loading:y,error:k,submitFilm:v}=B(),x=async()=>{u.value=!0;try{const a=(await K.get(`/api/films/${g}`)).data;m.value=a.film_id,r.value=a.status,c.value={judul:a.judul||"",category_id:a.category_id||"",sinopsis:a.sinopsis||"",tahun_karya:a.tahun_karya||new Date().getFullYear(),link_video_utama:a.link_video_utama||"",link_trailer:a.link_trailer||"",link_bts:a.link_bts||"",gambar_poster:a.gambar_poster||"",banner_url:a.banner_url||"",deskripsi_lengkap:a.deskripsi_lengkap||"",file_naskah:a.file_naskah||"",file_storyboard:a.file_storyboard||"",file_rab:a.file_rab||"",crew:a.crew&&a.crew.length>0?a.crew:[{jabatan:"",anggota:[""]}]}}catch{p("Gagal memuat data karya","error"),d.push("/my-archive")}finally{u.value=!1}},w=async i=>{let a="Karya berhasil diperbarui!";r.value==="published"&&(a='Karya diupdate! Status berubah ke "Menunggu Review".'),await v(i,m.value,a)},_=()=>{d.push("/my-archive")},j=i=>{p(i,"error")};return C(()=>{x()}),(i,a)=>(l(),n("div",N,[t(F),e("main",V,[e("div",G,[t(s(S),{variant:"outline",size:"sm",onClick:_},{default:P(()=>[t(s(M),{class:"w-4 h-4"})]),_:1}),a[0]||(a[0]=e("div",null,[e("h1",{class:"text-3xl md:text-4xl font-display text-stone-900"},"Edit Karya"),e("p",{class:"text-stone-500"},"Perubahan pada karya yang sudah dipublikasi akan memerlukan review ulang.")],-1))]),u.value?(l(),n("div",z,[t(s(D),{class:"w-8 h-8 animate-spin text-stone-400"})])):(l(),n($,{key:1},[r.value==="published"||r.value==="rejected"?(l(),n("div",H,[t(s(h),{class:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e("div",I,[a[1]||(a[1]=e("p",{class:"font-bold text-yellow-800"},"Perhatian",-1)),e("p",J," Karya ini sudah "+f(r.value==="published"?"dipublikasi":"ditolak")+'. Jika kamu menyimpan perubahan, status akan berubah menjadi "Menunggu Review" dan karya tidak akan tampil di beranda sampai disetujui kembali. ',1)])])):b("",!0),e("div",Y,[e("div",q,[t(s(h),{class:"w-5 h-5 text-amber-600"})]),a[2]||(a[2]=e("div",{class:"min-w-0"},[e("p",{class:"font-semibold text-stone-900 mb-2"},"Panduan kurasi saat merevisi karya"),e("ul",{class:"list-disc pl-5 text-sm text-stone-700 space-y-1"},[e("li",null,"Perbaiki catatan penolakan admin terkait audio, visual, atau durasi bila ada."),e("li",null,"Pastikan link video utama dan trailer masih aktif dan dapat diputar tanpa batasan."),e("li",null,"Perbarui sinopsis, tahun produksi, dan data kru jika terjadi perubahan signifikan."),e("li",null,"Gunakan poster yang jelas, tidak blur, dan merepresentasikan tema karya."),e("li",null,"Pastikan seluruh materi tidak melanggar hak cipta dan etika kampus.")])],-1))]),s(k)?(l(),n("div",O,f(s(k)),1)):b("",!0),t(L,{initialData:c.value,isEdit:!0,loading:s(y),onSubmit:w,onCancel:_,onError:j},null,8,["initialData","loading"])],64))]),t(A)]))}};export{ia as default};
