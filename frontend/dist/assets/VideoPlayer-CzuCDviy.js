import{J as E,f as I,p as v,aa as b,r as h,ab as k,g as c,o as i,F as P,a as L,n as V}from"./index-Cb00d5qB.js";const T={class:"w-full h-full"},B=["src"],H=["poster"],N=["src"],x={__name:"VideoPlayer",props:{src:{type:String,required:!0},title:{type:String,default:"Video"},poster:{type:String,default:""},storageKey:{type:String,default:""}},setup(f){const m=f,d=h(!1),o=v(()=>m.src||""),y=v(()=>{const t=o.value||"";return t.includes("youtube.com")||t.includes("youtu.be")}),w=v(()=>{const a=(o.value||"").match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\s]+)/);return a?`https://www.youtube.com/embed/${a[1]}?rel=0&modestbranding=1`:""}),e=h(null);let l=null,r=null,p=null;function S(){const t=m.storageKey||o.value;return t?`pfspace:progress:${t}`:null}return I(async()=>{if(!y.value)try{const[{default:t},a]=await Promise.all([b(()=>import("./plyr-Cwtstkjp.js"),[]),b(()=>import("./hls-DuDM7LWb.js"),[])]),s=o.value;if(/\.m3u8($|\\?)/i.test(s))if(a.default.isSupported())l=new a.default,l.loadSource(s),l.attachMedia(e.value);else if(e.value.canPlayType("application/vnd.apple.mpegurl"))e.value.src=s;else{d.value=!0;return}else e.value.src=s;r=new t(e.value,{controls:["play","progress","current-time","mute","volume","settings","pip","airplay","fullscreen"],invertTime:!1,speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2]}});const u=S();if(u){const _=localStorage.getItem(u),n=_?parseFloat(_):0;if(!isNaN(n)&&n>5){const g=()=>{e.value&&e.value.duration&&n<e.value.duration-5&&(e.value.currentTime=n),e.value.removeEventListener("loadedmetadata",g)};e.value.addEventListener("loadedmetadata",g)}p=setInterval(()=>{!e.value||e.value.paused||localStorage.setItem(u,String(e.value.currentTime||0))},5e3),e.value.addEventListener("ended",()=>{localStorage.removeItem(u)})}if(e.value&&e.value.controlsList)try{e.value.controlsList.add("nodownload")}catch{}}catch(t){console.error("Init Plyr/HLS failed:",t),d.value=!0}}),k(()=>{try{r&&typeof r.destroy=="function"&&r.destroy(),l&&typeof l.destroy=="function"&&l.destroy(),p&&clearInterval(p)}catch{}}),(t,a)=>(i(),c("div",T,[y.value?(i(),c("iframe",{key:0,src:w.value,class:"w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",allowfullscreen:""},null,8,B)):(i(),c(P,{key:1},[L("video",{ref_key:"videoEl",ref:e,poster:f.poster||null,playsinline:"",controls:"",class:"w-full h-full bg-black object-contain"},null,8,H),d.value?(i(),c("video",{key:0,src:o.value||null,controls:"",class:"hidden"},null,8,N)):V("",!0)],64))]))}},$=E(x,[["__scopeId","data-v-423605e7"]]);export{$ as V};
