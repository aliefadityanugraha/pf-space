import{f as H,g as c,a,h as t,n as B,w as o,B as d,a0 as U,k as s,A as M,E as m,aN as N,aK as q,aL as O,z as X,r,L as T,F as z,q as Y,G as I,C as p,X as J,Y as Q,l as S,c as w,an as R,a2 as E,t as h,H as W,o as n}from"./index-CdiZ0yiz.js";import{_ as Z}from"./PageHeader-CXGgszjw.js";import{P as ee}from"./plus-BgJKWeAU.js";import{S as ae}from"./save-BvsUDgME.js";import{P as se}from"./pencil-C9LI9NL2.js";const te={class:"p-4 md:p-8"},le={class:"flex items-center gap-2 text-xs font-mono uppercase tracking-wider mb-4"},oe={class:"flex items-center gap-3"},ie={key:0,class:"flex items-center justify-center py-12"},ne={key:1,class:"text-center py-12 text-stone-400"},re={class:"md:col-span-4"},de={class:"font-bold text-stone-900"},ue={class:"md:col-span-5 text-sm text-stone-600"},ce={class:"md:col-span-1 text-center"},me={class:"md:col-span-2 flex gap-2 md:justify-end"},pe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},ve={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-md mx-4"},ge={class:"flex items-center justify-between px-6 py-4 border-b-2 border-black bg-stone-100"},fe={class:"font-bold text-lg"},be={key:0,class:"p-3 bg-red-50 border border-red-200 text-red-600 text-sm"},ke={class:"flex gap-3 pt-4"},_e={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},xe={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-sm mx-4"},ye={class:"flex items-center gap-3 px-6 py-4 border-b-2 border-black bg-red-50"},we={class:"font-bold text-lg text-red-800"},he={class:"p-6"},Ce={class:"text-stone-600 mb-6"},Ke={class:"flex gap-3"},je={__name:"Categories",setup($e){const C=r([]),K=r(!0),_=r(!1),g=r(!1),$=r(!1),f=r(null),u=r({nama_kategori:"",deskripsi:""}),v=r(""),b=r(!1),D=r({title:"",message:"",onConfirm:null}),{showToast:k}=W(),V=async()=>{K.value=!0;try{const l=await h.get("/api/categories/with-count");C.value=l.data}catch(l){console.error("Failed to fetch categories:",l),k("Gagal memuat kategori","error")}finally{K.value=!1}},j=(l=null)=>{f.value=l,u.value=l?{nama_kategori:l.nama_kategori,deskripsi:l.deskripsi||""}:{nama_kategori:"",deskripsi:""},v.value="",$.value=!0},x=()=>{$.value=!1,f.value=null,u.value={nama_kategori:"",deskripsi:""}},F=async()=>{if(!u.value.nama_kategori.trim()){v.value="Nama kategori wajib diisi";return}_.value=!0,v.value="";try{f.value?(await h.put(`/api/categories/${f.value.category_id}`,u.value),k("Kategori berhasil diperbarui")):(await h.post("/api/categories",u.value),k("Kategori berhasil ditambahkan")),x(),await V()}catch(l){v.value=l.message||"Gagal menyimpan kategori"}finally{_.value=!1}},y=r(null),G=l=>{y.value=l,D.value={title:"Hapus Kategori",message:`Apakah Anda yakin ingin menghapus kategori "${l.nama_kategori}"?`},b.value=!0},L=async()=>{if(y.value){g.value=!0;try{await h.delete(`/api/categories/${y.value.category_id}`),k("Kategori berhasil dihapus"),await V()}catch(l){k(l.message||"Gagal menghapus kategori","error")}finally{g.value=!1,b.value=!1,y.value=null}}};return H(V),(l,e)=>{const A=U("router-link");return n(),c("div",te,[a("nav",le,[t(A,{to:"/",class:"text-brand-teal hover:underline"},{default:o(()=>[...e[5]||(e[5]=[d("Beranda",-1)])]),_:1}),e[8]||(e[8]=a("span",{class:"text-stone-400"},"/",-1)),t(A,{to:"/admin",class:"text-stone-600 hover:underline"},{default:o(()=>[...e[6]||(e[6]=[d("Administrasi",-1)])]),_:1}),e[9]||(e[9]=a("span",{class:"text-stone-400"},"/",-1)),t(s(M),{variant:"outline",class:"bg-orange-100 text-orange-700 border-orange-300"},{default:o(()=>[...e[7]||(e[7]=[d("Kategori",-1)])]),_:1})]),t(Z,{title:"Kelola Kategori",description:"Kelola kategori Karya untuk mengorganisir arsip.",icon:s(N),"icon-color":"bg-teal-500"},{actions:o(()=>[t(s(m),{onClick:e[0]||(e[0]=i=>j()),class:"gap-2"},{default:o(()=>[t(s(ee),{class:"w-4 h-4"}),e[10]||(e[10]=d(" Tambah Kategori ",-1))]),_:1})]),_:1},8,["icon"]),t(s(I),null,{default:o(()=>[t(s(q),{class:"bg-teal-50 border-b-2 border-stone-800"},{default:o(()=>[a("div",oe,[t(s(N),{class:"w-5 h-5"}),t(s(O),{class:"text-lg font-bold uppercase"},{default:o(()=>[...e[11]||(e[11]=[d("Daftar Kategori",-1)])]),_:1})])]),_:1}),t(s(X),{class:"p-0"},{default:o(()=>[K.value?(n(),c("div",ie,[t(s(T),{class:"w-8 h-8 animate-spin text-stone-400"}),e[12]||(e[12]=a("p",{class:"text-stone-500 font-mono uppercase tracking-widest animate-pulse"},"Memuat Kategori...",-1))])):C.value.length===0?(n(),c("div",ne,[t(s(N),{class:"w-12 h-12 mx-auto mb-2 opacity-50"}),e[13]||(e[13]=a("p",null,"Belum ada kategori",-1))])):(n(),c(z,{key:2},[e[14]||(e[14]=a("div",{class:"hidden md:grid grid-cols-12 gap-4 px-6 py-3 bg-lime-50 border-b-2 border-stone-800 text-xs font-bold uppercase tracking-wider"},[a("div",{class:"col-span-4"},"Nama Kategori"),a("div",{class:"col-span-5"},"Deskripsi"),a("div",{class:"col-span-1 text-center"},"Karyas"),a("div",{class:"col-span-2 text-right"},"Aksi")],-1)),(n(!0),c(z,null,Y(C.value,i=>(n(),c("div",{key:i.category_id,class:"grid grid-cols-1 md:grid-cols-12 gap-4 px-6 py-4 items-center border-b border-stone-200 hover:bg-stone-50"},[a("div",re,[a("span",de,p(i.nama_kategori),1)]),a("div",ue,p(i.deskripsi||"-"),1),a("div",ce,[t(s(M),{variant:"secondary"},{default:o(()=>[d(p(i.film_count||0),1)]),_:2},1024)]),a("div",me,[t(s(m),{variant:"outline",size:"sm",onClick:P=>j(i)},{default:o(()=>[t(s(se),{class:"w-4 h-4"})]),_:1},8,["onClick"]),t(s(m),{variant:"outline",size:"sm",class:"text-red-600 hover:bg-red-50",onClick:P=>G(i)},{default:o(()=>[t(s(E),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128))],64))]),_:1})]),_:1}),$.value?(n(),c("div",pe,[a("div",{class:"absolute inset-0 bg-black/50",onClick:x}),a("div",ve,[a("div",ge,[a("h2",fe,p(f.value?"Edit Kategori":"Tambah Kategori"),1),a("button",{onClick:x,class:"p-1 hover:bg-stone-200"},[t(s(J),{class:"w-5 h-5"})])]),a("form",{onSubmit:Q(F,["prevent"]),class:"p-6 space-y-4"},[v.value?(n(),c("div",be,p(v.value),1)):B("",!0),a("div",null,[e[15]||(e[15]=a("label",{class:"block text-sm font-bold mb-2"},"Nama Kategori *",-1)),t(s(S),{modelValue:u.value.nama_kategori,"onUpdate:modelValue":e[1]||(e[1]=i=>u.value.nama_kategori=i),placeholder:"Contoh: Documentary"},null,8,["modelValue"])]),a("div",null,[e[16]||(e[16]=a("label",{class:"block text-sm font-bold mb-2"},"Deskripsi",-1)),t(s(S),{modelValue:u.value.deskripsi,"onUpdate:modelValue":e[2]||(e[2]=i=>u.value.deskripsi=i),placeholder:"Deskripsi singkat kategori"},null,8,["modelValue"])]),a("div",ke,[t(s(m),{type:"button",variant:"outline",class:"flex-1",onClick:x},{default:o(()=>[...e[17]||(e[17]=[d("Batal",-1)])]),_:1}),t(s(m),{type:"submit",class:"flex-1 gap-2",disabled:_.value},{default:o(()=>[_.value?(n(),w(s(T),{key:0,class:"w-4 h-4 animate-spin"})):(n(),w(s(ae),{key:1,class:"w-4 h-4"})),e[18]||(e[18]=d(" Simpan ",-1))]),_:1},8,["disabled"])])],32)])])):B("",!0),b.value?(n(),c("div",_e,[a("div",{class:"absolute inset-0 bg-black/50",onClick:e[3]||(e[3]=i=>b.value=!1)}),a("div",xe,[a("div",ye,[t(s(R),{class:"w-5 h-5 text-red-600"}),a("h2",we,p(D.value.title),1)]),a("div",he,[a("p",Ce,p(D.value.message),1),a("div",Ke,[t(s(m),{type:"button",variant:"outline",class:"flex-1",onClick:e[4]||(e[4]=i=>b.value=!1),disabled:g.value},{default:o(()=>[...e[19]||(e[19]=[d(" Batal ",-1)])]),_:1},8,["disabled"]),t(s(m),{type:"button",class:"flex-1 gap-2 bg-red-600 hover:bg-red-700",onClick:L,disabled:g.value},{default:o(()=>[g.value?(n(),w(s(T),{key:0,class:"w-4 h-4 animate-spin"})):(n(),w(s(E),{key:1,class:"w-4 h-4"})),e[20]||(e[20]=d(" Hapus ",-1))]),_:1},8,["disabled"])])])])])):B("",!0)])}}};export{je as default};
