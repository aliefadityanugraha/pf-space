import{f as L,g as c,h as t,a,n as V,r,w as o,B as d,U as q,k as s,A as M,E as m,aA as O,aB as X,z as I,L as A,F as S,q as J,G as Q,D as R,C as p,a8 as W,aj as Y,l as F,c as w,ac as Z,$ as E,t as h,H as ee,o as n}from"./index-nbuW1C-Z.js";import{A as ae,F as T}from"./SidebarAdmin-CYotWZnb.js";import{_ as se}from"./PageHeader-CBGTbqNy.js";import{P as te}from"./plus-CqLjIM8p.js";import{S as le}from"./save-CGtZI-as.js";import{P as oe}from"./pencil-BYDdCpRz.js";import"./shield-BaoCScyT.js";import"./file-text-Qj2K4aNE.js";import"./settings-D7S0Yl72.js";const ie={class:"min-h-screen bg-stone-100"},ne={class:"flex items-center gap-2 text-xs font-mono uppercase tracking-wider mb-4"},re={class:"flex items-center gap-3"},de={key:0,class:"flex items-center justify-center py-12"},ue={key:1,class:"text-center py-12 text-stone-400"},ce={class:"md:col-span-4"},me={class:"font-bold text-stone-900"},pe={class:"md:col-span-5 text-sm text-stone-600"},ve={class:"md:col-span-1 text-center"},ge={class:"md:col-span-2 flex gap-2 md:justify-end"},fe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},be={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-md mx-4"},ke={class:"flex items-center justify-between px-6 py-4 border-b-2 border-black bg-stone-100"},xe={class:"font-bold text-lg"},_e={key:0,class:"p-3 bg-red-50 border border-red-200 text-red-600 text-sm"},ye={class:"flex gap-3 pt-4"},we={key:1,class:"fixed inset-0 z-50 flex items-center justify-center"},he={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-sm mx-4"},Ce={class:"flex items-center gap-3 px-6 py-4 border-b-2 border-black bg-red-50"},Ke={class:"font-bold text-lg text-red-800"},$e={class:"p-6"},De={class:"text-stone-600 mb-6"},Be={class:"flex gap-3"},Ge={__name:"Categories",setup(Ve){const j=r(!1),C=r([]),K=r(!0),x=r(!1),g=r(!1),$=r(!1),f=r(null),u=r({nama_kategori:"",deskripsi:""}),v=r(""),b=r(!1),D=r({title:"",message:"",onConfirm:null}),{showToast:k}=ee(),B=async()=>{K.value=!0;try{const l=await h.get("/api/categories/with-count");C.value=l.data}catch(l){console.error("Failed to fetch categories:",l),k("Gagal memuat kategori","error")}finally{K.value=!1}},N=(l=null)=>{f.value=l,u.value=l?{nama_kategori:l.nama_kategori,deskripsi:l.deskripsi||""}:{nama_kategori:"",deskripsi:""},v.value="",$.value=!0},_=()=>{$.value=!1,f.value=null,u.value={nama_kategori:"",deskripsi:""}},G=async()=>{if(!u.value.nama_kategori.trim()){v.value="Nama kategori wajib diisi";return}x.value=!0,v.value="";try{f.value?(await h.put(`/api/categories/${f.value.category_id}`,u.value),k("Kategori berhasil diperbarui")):(await h.post("/api/categories",u.value),k("Kategori berhasil ditambahkan")),_(),await B()}catch(l){v.value=l.message||"Gagal menyimpan kategori"}finally{x.value=!1}},y=r(null),P=l=>{y.value=l,D.value={title:"Hapus Kategori",message:`Apakah Anda yakin ingin menghapus kategori "${l.nama_kategori}"?`},b.value=!0},U=async()=>{if(y.value){g.value=!0;try{await h.delete(`/api/categories/${y.value.category_id}`),k("Kategori berhasil dihapus"),await B()}catch(l){k(l.message||"Gagal menghapus kategori","error")}finally{g.value=!1,b.value=!1,y.value=null}}};return L(B),(l,e)=>{const z=q("router-link");return n(),c("div",ie,[t(ae,{"onUpdate:collapsed":e[0]||(e[0]=i=>j.value=i)}),a("main",{class:R(["p-4 md:p-8 transition-all duration-300",j.value?"ml-14":"ml-56"])},[a("nav",ne,[t(z,{to:"/",class:"text-brand-teal hover:underline"},{default:o(()=>[...e[6]||(e[6]=[d("Beranda",-1)])]),_:1}),e[9]||(e[9]=a("span",{class:"text-stone-400"},"/",-1)),t(z,{to:"/admin",class:"text-stone-600 hover:underline"},{default:o(()=>[...e[7]||(e[7]=[d("Administrasi",-1)])]),_:1}),e[10]||(e[10]=a("span",{class:"text-stone-400"},"/",-1)),t(s(M),{variant:"outline",class:"bg-orange-100 text-orange-700 border-orange-300"},{default:o(()=>[...e[8]||(e[8]=[d("Kategori",-1)])]),_:1})]),t(se,{title:"Kelola Kategori",description:"Kelola kategori Karya untuk mengorganisir arsip.",icon:s(T),"icon-color":"bg-teal-500"},{actions:o(()=>[t(s(m),{onClick:e[1]||(e[1]=i=>N()),class:"gap-2"},{default:o(()=>[t(s(te),{class:"w-4 h-4"}),e[11]||(e[11]=d(" Tambah Kategori ",-1))]),_:1})]),_:1},8,["icon"]),t(s(Q),null,{default:o(()=>[t(s(O),{class:"bg-teal-50 border-b-2 border-stone-800"},{default:o(()=>[a("div",re,[t(s(T),{class:"w-5 h-5"}),t(s(X),{class:"text-lg font-bold uppercase"},{default:o(()=>[...e[12]||(e[12]=[d("Daftar Kategori",-1)])]),_:1})])]),_:1}),t(s(I),{class:"p-0"},{default:o(()=>[K.value?(n(),c("div",de,[t(s(A),{class:"w-8 h-8 animate-spin text-stone-400"}),e[13]||(e[13]=a("p",{class:"text-stone-500 font-mono uppercase tracking-widest animate-pulse"},"Memuat Kategori...",-1))])):C.value.length===0?(n(),c("div",ue,[t(s(T),{class:"w-12 h-12 mx-auto mb-2 opacity-50"}),e[14]||(e[14]=a("p",null,"Belum ada kategori",-1))])):(n(),c(S,{key:2},[e[15]||(e[15]=a("div",{class:"hidden md:grid grid-cols-12 gap-4 px-6 py-3 bg-lime-50 border-b-2 border-stone-800 text-xs font-bold uppercase tracking-wider"},[a("div",{class:"col-span-4"},"Nama Kategori"),a("div",{class:"col-span-5"},"Deskripsi"),a("div",{class:"col-span-1 text-center"},"Karyas"),a("div",{class:"col-span-2 text-right"},"Aksi")],-1)),(n(!0),c(S,null,J(C.value,i=>(n(),c("div",{key:i.category_id,class:"grid grid-cols-1 md:grid-cols-12 gap-4 px-6 py-4 items-center border-b border-stone-200 hover:bg-stone-50"},[a("div",ce,[a("span",me,p(i.nama_kategori),1)]),a("div",pe,p(i.deskripsi||"-"),1),a("div",ve,[t(s(M),{variant:"secondary"},{default:o(()=>[d(p(i.film_count||0),1)]),_:2},1024)]),a("div",ge,[t(s(m),{variant:"outline",size:"sm",onClick:H=>N(i)},{default:o(()=>[t(s(oe),{class:"w-4 h-4"})]),_:1},8,["onClick"]),t(s(m),{variant:"outline",size:"sm",class:"text-red-600 hover:bg-red-50",onClick:H=>P(i)},{default:o(()=>[t(s(E),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128))],64))]),_:1})]),_:1})],2),$.value?(n(),c("div",fe,[a("div",{class:"absolute inset-0 bg-black/50",onClick:_}),a("div",be,[a("div",ke,[a("h2",xe,p(f.value?"Edit Kategori":"Tambah Kategori"),1),a("button",{onClick:_,class:"p-1 hover:bg-stone-200"},[t(s(W),{class:"w-5 h-5"})])]),a("form",{onSubmit:Y(G,["prevent"]),class:"p-6 space-y-4"},[v.value?(n(),c("div",_e,p(v.value),1)):V("",!0),a("div",null,[e[16]||(e[16]=a("label",{class:"block text-sm font-bold mb-2"},"Nama Kategori *",-1)),t(s(F),{modelValue:u.value.nama_kategori,"onUpdate:modelValue":e[2]||(e[2]=i=>u.value.nama_kategori=i),placeholder:"Contoh: Documentary"},null,8,["modelValue"])]),a("div",null,[e[17]||(e[17]=a("label",{class:"block text-sm font-bold mb-2"},"Deskripsi",-1)),t(s(F),{modelValue:u.value.deskripsi,"onUpdate:modelValue":e[3]||(e[3]=i=>u.value.deskripsi=i),placeholder:"Deskripsi singkat kategori"},null,8,["modelValue"])]),a("div",ye,[t(s(m),{type:"button",variant:"outline",class:"flex-1",onClick:_},{default:o(()=>[...e[18]||(e[18]=[d("Batal",-1)])]),_:1}),t(s(m),{type:"submit",class:"flex-1 gap-2",disabled:x.value},{default:o(()=>[x.value?(n(),w(s(A),{key:0,class:"w-4 h-4 animate-spin"})):(n(),w(s(le),{key:1,class:"w-4 h-4"})),e[19]||(e[19]=d(" Simpan ",-1))]),_:1},8,["disabled"])])],32)])])):V("",!0),b.value?(n(),c("div",we,[a("div",{class:"absolute inset-0 bg-black/50",onClick:e[4]||(e[4]=i=>b.value=!1)}),a("div",he,[a("div",Ce,[t(s(Z),{class:"w-5 h-5 text-red-600"}),a("h2",Ke,p(D.value.title),1)]),a("div",$e,[a("p",De,p(D.value.message),1),a("div",Be,[t(s(m),{type:"button",variant:"outline",class:"flex-1",onClick:e[5]||(e[5]=i=>b.value=!1),disabled:g.value},{default:o(()=>[...e[20]||(e[20]=[d(" Batal ",-1)])]),_:1},8,["disabled"]),t(s(m),{type:"button",class:"flex-1 gap-2 bg-red-600 hover:bg-red-700",onClick:U,disabled:g.value},{default:o(()=>[g.value?(n(),w(s(A),{key:0,class:"w-4 h-4 animate-spin"})):(n(),w(s(E),{key:1,class:"w-4 h-4"})),e[21]||(e[21]=d(" Hapus ",-1))]),_:1},8,["disabled"])])])])])):V("",!0)])}}};export{Ge as default};
