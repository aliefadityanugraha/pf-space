import{e as xt,J as ht,a4 as J,u as ft,f as vt,a6 as wt,r as d,c as h,w as n,a as e,g as m,n as w,k as s,p as R,h as a,V as z,C as u,B as b,A as L,D as B,at as gt,z as N,R as E,G as H,Y as O,E as g,T as yt,ar as kt,F as _t,q as Pt,l as V,L as q,a2 as jt,au as Ct,t as y,O as Y,o as l,H as Vt}from"./index-6yk5-dep.js";import{_ as Ft}from"./PageLayout-DUPs5WY7.js";import{_ as $t,T as Q}from"./LoadingState-DbAnd5h7.js";import{S as W}from"./settings-ljijGGQR.js";const Dt=xt("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Tt={class:"max-w-7xl mx-auto mb-16"},Ut={class:"flex flex-col md:flex-row items-center gap-5 md:gap-6 mb-8 p-5 md:p-6 bg-white border-2 border-white/20 shadow-brutal relative z-10 mx-1 md:mx-0"},It={class:"relative group flex-shrink-0"},St={class:"w-20 h-20 md:w-24 md:h-24 border-2 border-black bg-stone-200 overflow-hidden shadow-sm relative"},Lt=["src","alt"],At={key:1,class:"w-full h-full flex items-center justify-center bg-brand-teal/20"},Kt={class:"flex-1 text-center md:text-left min-w-0"},Rt={class:"flex flex-col md:flex-row items-center gap-2 md:gap-3 mb-1 justify-center md:justify-start"},zt={class:"text-xl md:text-3xl font-display font-bold text-stone-900 uppercase tracking-wide truncate max-w-full"},Bt={class:"text-stone-600 text-[10px] md:text-sm font-medium border-b-2 border-dashed border-stone-300 inline-block pb-0.5 mb-2 truncate max-w-full"},Nt={class:"flex items-center justify-center md:justify-start gap-2 text-[9px] md:text-xs font-bold uppercase tracking-widest text-stone-400 mt-0.5"},Et={key:0,class:"flex gap-2 border-l-2 border-black pl-6 hidden md:flex"},Ht={class:"text-center px-4"},Mt={class:"text-2xl font-display font-bold text-stone-900"},Gt={class:"text-center px-4 border-l-2 border-dashed border-stone-300"},Jt={class:"text-2xl font-display font-bold text-stone-900"},Ot={class:"flex gap-2.5 md:gap-4 mb-8 overflow-x-auto pb-2 scrollbar-hide px-1 md:px-0"},qt={key:0},Yt={key:0},Qt={key:1,class:"space-y-8 animate-fade-in"},Wt={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 md:gap-4 px-1"},Xt={class:"w-10 h-10 md:w-12 md:h-12 bg-stone-100 border-2 border-black flex items-center justify-center shadow-sm flex-shrink-0"},Zt={class:"text-2xl md:text-4xl font-display font-bold text-stone-900 md:mb-1"},te={class:"w-10 h-10 md:w-12 md:h-12 bg-brand-teal/20 border-2 border-black flex items-center justify-center shadow-sm flex-shrink-0"},ee={class:"text-2xl md:text-4xl font-display font-bold text-stone-900 md:mb-1"},se={class:"w-10 h-10 md:w-12 md:h-12 bg-brand-orange/20 border-2 border-black flex items-center justify-center shadow-sm flex-shrink-0"},ae={class:"text-2xl md:text-4xl font-display font-bold text-stone-900 md:mb-1"},oe={class:"flex items-center justify-between mb-4 border-b-2 border-black pb-2"},le={key:0,class:"text-center py-12 border-2 border-dashed border-stone-400 bg-stone-50/50"},re={key:1,class:"space-y-3 md:space-y-4 px-1"},de={class:"w-10 h-14 md:w-12 md:h-16 bg-stone-200 flex-shrink-0 overflow-hidden border border-black relative"},ne=["src"],ie={key:1,class:"w-full h-full flex items-center justify-center bg-stone-100"},ue={class:"flex-1 min-w-0"},me={class:"text-xs md:text-sm font-display font-bold text-stone-900 truncate uppercase"},be={class:"text-[9px] md:text-xs font-mono text-stone-500 mb-1.5 border-b border-dashed border-stone-200 pb-0.5 w-fit"},ce={class:"text-right flex flex-col gap-1.5"},pe={key:1,class:"text-center py-16 border-2 border-black bg-white shadow-brutal"},xe={class:"w-20 h-20 bg-brand-orange border-2 border-black flex items-center justify-center mx-auto mb-6 shadow-brutal"},he={class:"flex justify-center gap-4"},fe={key:1,class:"animate-fade-in max-w-7xl mx-auto space-y-8"},ve={class:"bg-white p-6 border-2 border-black shadow-brutal relative"},we={class:"font-display font-bold text-xl text-stone-900 mb-6 border-b-2 border-black pb-2 flex items-center gap-2"},ge={class:"space-y-5 md:space-y-6"},ye={class:"pt-2"},ke={class:"bg-white p-6 border-2 border-black shadow-brutal relative"},_e={class:"font-display font-bold text-xl text-stone-900 mb-6 border-b-2 border-black pb-2 flex items-center gap-2"},Pe={class:"space-y-5 md:space-y-6"},je={class:"relative"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-5 md:gap-6"},Ve={class:"pt-2"},Fe={__name:"Profile",setup($e){const k=yt(),{user:c,refreshUser:X,initialized:Z,isLoggedIn:tt,isCreator:A}=wt(),{showToast:_}=Vt(),M=d(null),et=R(()=>Y(c.value?.image||"")),f=d("dashboard");J([Z,tt],([r,t])=>{r&&!t&&k.push("/auth/login")},{immediate:!0}),ft({title:()=>c.value?`Profil: ${c.value.name} - PF Space`:"Profil Saya - PF Space"});const P=d(""),F=d(""),j=d(""),$=d(""),D=d(!1),st=d(!1),at=d(!1),T=d(!1),U=d(!1);J(c,r=>{r&&(P.value=r.name||"")},{immediate:!0});const ot=R(()=>c.value?.role?.name||"user"),lt=R(()=>c.value?.created_at?new Date(c.value.created_at).toLocaleDateString("id-ID",{month:"long",year:"numeric"}):"Unknown"),C=d(null),K=d(null),I=d(!0),G=d(""),S=d([]),v=d({totalFilms:0,pending:0,published:0,rejected:0,totalVotes:0,totalComments:0}),rt={pending:"bg-yellow-100 text-yellow-900 border-yellow-900",published:"bg-brand-teal text-white border-black",rejected:"bg-brand-red text-white border-black"},dt={pending:"Menunggu Review",published:"Dipublikasi",rejected:"Ditolak"},nt=async()=>{I.value=!0,G.value="";try{const r=await y.get("/api/films/my-films",{params:{page:1,limit:10}}),t=Array.isArray(r.data)?r.data:[],o={};t.length>0&&await Promise.all(t.map(async i=>{const p=i.film_id;try{const[ct,pt]=await Promise.all([y.get(`/api/votes/${p}`),y.get(`/api/discussions/film/${p}/count`)]);o[p]={vote_count:ct.data?.vote_count??0,comment_count:pt.data?.comment_count??0}}catch{o[p]={vote_count:0,comment_count:0}}}));const x=t.map(i=>{const p=o[i.film_id]||{};return{...i,gambar_poster:Y(i.gambar_poster),vote_count:p.vote_count||0,comment_count:p.comment_count||0}});S.value=x,v.value={totalFilms:x.length,pending:x.filter(i=>i.status==="pending").length,published:x.filter(i=>i.status==="published").length,rejected:x.filter(i=>i.status==="rejected").length,totalVotes:x.reduce((i,p)=>i+(p.vote_count||0),0),totalComments:x.reduce((i,p)=>i+(p.comment_count||0),0)}}catch(r){G.value="Gagal memuat data dashboard.",console.error(r)}finally{I.value=!1}},it=()=>{M.value.click()},ut=r=>{const t=r.target.files[0];if(t){C.value=t;const o=new FileReader;o.onload=x=>{K.value=x.target.result},o.readAsDataURL(t)}},mt=async()=>{T.value=!0;try{const r=new FormData;r.append("name",P.value),C.value&&r.append("image",C.value),C.value?await y.upload("/api/auth/update-user",r,{method:"PATCH"}):await y.patch("/api/auth/update-user",{name:P.value}),await X(),_("Profil berhasil diperbarui!"),C.value=null}catch(r){_(r.message||"Gagal memperbarui profil","error")}finally{T.value=!1}},bt=async()=>{if(j.value!==$.value){_("Password tidak cocok","error");return}U.value=!0;try{await y.post("/api/auth/change-password",{currentPassword:F.value,newPassword:j.value}),F.value="",j.value="",$.value="",_("Password berhasil diubah!")}catch(r){_(r.message||"Gagal mengubah password","error")}finally{U.value=!1}};return vt(()=>{A.value?nt():I.value=!1}),(r,t)=>(l(),h(Ft,null,{default:n(()=>[e("div",Tt,[e("div",Ut,[t[13]||(t[13]=e("div",{class:"absolute top-2 right-2 md:top-3 md:right-3 flex gap-1"},[e("div",{class:"w-1.5 h-1.5 md:w-2 md:h-2 bg-black rounded-full"}),e("div",{class:"w-1.5 h-1.5 md:w-2 md:h-2 bg-black rounded-full"})],-1)),e("div",It,[e("input",{type:"file",ref_key:"fileInput",ref:M,class:"hidden",accept:"image/*",onChange:ut},null,544),e("div",St,[K.value||s(c)?.image?(l(),m("img",{key:0,src:K.value||et.value,alt:s(c)?.name,class:"w-full h-full object-cover"},null,8,Lt)):(l(),m("div",At,[a(s(z),{class:"w-8 h-8 md:w-10 md:h-10 text-stone-900"})]))]),e("button",{onClick:it,class:"absolute -bottom-1 -right-1 md:-bottom-2 md:-right-2 w-7 h-7 md:w-8 md:h-8 bg-brand-teal border-2 border-black flex items-center justify-center hover:translate-x-[1px] hover:translate-y-[1px] transition-transform cursor-pointer shadow-brutal-xs md:shadow-brutal-sm text-white",title:"Ganti Foto"},[a(s(Dt),{class:"w-3.5 h-3.5 md:w-4 md:h-4 text-white"})])]),e("div",Kt,[e("div",Rt,[e("h1",zt,u(s(c)?.name||"User"),1),a(s(L),{variant:"outline",class:"capitalize border-2 border-black bg-brand-orange text-stone-900 font-bold shadow-brutal-xs md:shadow-brutal-sm text-[10px] md:text-xs px-2 py-0.5"},{default:n(()=>[b(u(ot.value),1)]),_:1})]),e("p",Bt,u(s(c)?.email),1),e("div",Nt,[e("span",null,"Bergabung "+u(lt.value),1)])]),s(A)?(l(),m("div",Et,[e("div",Ht,[e("div",Mt,u(v.value.totalFilms),1),t[11]||(t[11]=e("div",{class:"text-[10px] uppercase font-bold text-stone-500 tracking-widest"},"Karya",-1))]),e("div",Gt,[e("div",Jt,u(v.value.totalVotes),1),t[12]||(t[12]=e("div",{class:"text-[10px] uppercase font-bold text-stone-500 tracking-widest"},"Vote",-1))])])):w("",!0)]),e("div",Ot,[e("button",{onClick:t[0]||(t[0]=o=>f.value="dashboard"),class:B(["px-4 md:px-6 py-2.5 md:py-3 font-display font-bold uppercase tracking-widest text-[10px] md:text-sm border-2 border-black transition-all shadow-brutal-xs flex items-center gap-1.5 md:gap-2 whitespace-nowrap",f.value==="dashboard"?"bg-brand-teal text-white translate-x-[1px] translate-y-[1px] shadow-none":"bg-white text-stone-900"])},[a(s(gt),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),t[14]||(t[14]=b(" Ringkasan ",-1))],2),e("button",{onClick:t[1]||(t[1]=o=>f.value="settings"),class:B(["px-4 md:px-6 py-2.5 md:py-3 font-display font-bold uppercase tracking-widest text-[10px] md:text-sm border-2 border-black transition-all shadow-brutal-xs flex items-center gap-1.5 md:gap-2 whitespace-nowrap",f.value==="settings"?"bg-stone-900 text-white translate-x-[1px] translate-y-[1px] shadow-none":"bg-white text-stone-900"])},[a(s(W),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),t[15]||(t[15]=b(" Pengaturan ",-1))],2)]),f.value==="dashboard"?(l(),m("div",qt,[s(A)?(l(),m("div",Yt,[I.value?(l(),h($t,{key:0,text:"Memuat statistik...",class:"py-10"})):(l(),m("div",Qt,[e("div",Wt,[a(s(H),{class:"bg-white border-2 border-black shadow-brutal"},{default:n(()=>[a(s(N),{class:"p-3 md:p-5 flex items-center md:flex-col justify-start md:justify-center text-left md:text-center gap-3"},{default:n(()=>[e("div",Xt,[a(s(E),{class:"w-5 h-5 md:w-6 md:h-6 text-stone-900"})]),e("div",null,[e("div",Zt,u(v.value.totalFilms),1),t[16]||(t[16]=e("div",{class:"text-[9px] md:text-[10px] uppercase font-bold text-stone-500 tracking-widest"},"Total Karya",-1))])]),_:1})]),_:1}),a(s(H),{class:"bg-white border-2 border-black shadow-brutal"},{default:n(()=>[a(s(N),{class:"p-3 md:p-5 flex items-center md:flex-col justify-start md:justify-center text-left md:text-center gap-3"},{default:n(()=>[e("div",te,[a(s(Q),{class:"w-5 h-5 md:w-6 md:h-6 text-brand-teal"})]),e("div",null,[e("div",ee,u(v.value.totalVotes),1),t[17]||(t[17]=e("div",{class:"text-[9px] md:text-[10px] uppercase font-bold text-stone-500 tracking-widest"},"Total Apresiasi",-1))])]),_:1})]),_:1}),a(s(H),{class:"bg-white border-2 border-black shadow-brutal"},{default:n(()=>[a(s(N),{class:"p-3 md:p-5 flex items-center md:flex-col justify-start md:justify-center text-left md:text-center gap-3"},{default:n(()=>[e("div",se,[a(s(O),{class:"w-5 h-5 md:w-6 md:h-6 text-brand-orange"})]),e("div",null,[e("div",ae,u(v.value.totalComments),1),t[18]||(t[18]=e("div",{class:"text-[9px] md:text-[10px] uppercase font-bold text-stone-500 tracking-widest"},"Total Diskusi",-1))])]),_:1})]),_:1})]),e("div",null,[e("div",oe,[t[20]||(t[20]=e("h3",{class:"font-display font-bold text-xl text-stone-900 uppercase tracking-wide"},"Karya Terbaru Saya",-1)),S.value.length>0?(l(),h(s(g),{key:0,variant:"outline",size:"sm",class:"h-8 text-xs font-bold border-2 border-black shadow-brutal hover:shadow-none hover:translate-x-[1px] hover:translate-y-[1px]",onClick:t[2]||(t[2]=o=>s(k).push("/my-archive"))},{default:n(()=>[...t[19]||(t[19]=[b(" Kelola Semua ",-1)])]),_:1})):w("",!0)]),S.value.length===0?(l(),m("div",le,[a(s(E),{class:"w-12 h-12 mx-auto text-stone-300 mb-3"}),t[22]||(t[22]=e("p",{class:"font-bold text-stone-600 mb-4"},"Belum ada karya yang diupload.",-1)),a(s(g),{size:"sm",onClick:t[3]||(t[3]=o=>s(k).push("/upload")),class:"bg-stone-900 text-white gap-2 border-2 border-black shadow-brutal hover:shadow-none hover:translate-x-[1px] hover:translate-y-[1px]"},{default:n(()=>[a(s(kt),{class:"w-4 h-4"}),t[21]||(t[21]=b(" Upload Karya Pertama ",-1))]),_:1})])):(l(),m("div",re,[(l(!0),m(_t,null,Pt(S.value,o=>(l(),m("div",{key:o.film_id,class:"flex items-center gap-3 md:gap-4 p-3 md:p-4 bg-white border-2 border-black shadow-brutal hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-brutal-sm transition-all overflow-hidden"},[e("div",de,[o.gambar_poster?(l(),m("img",{key:0,src:o.gambar_poster,class:"w-full h-full object-cover"},null,8,ne)):(l(),m("div",ie,[a(s(E),{class:"w-4 h-4 md:w-5 md:h-5 text-stone-400"})]))]),e("div",ue,[e("h4",me,u(o.judul),1),e("p",be,u(o.tahun_karya)+" • "+u(o.category?.nama_kategori),1),a(s(L),{class:B(["text-[8px] md:text-[10px] px-1.5 md:px-2 py-0 md:py-0.5 rounded-none border md:border-2 font-bold uppercase",rt[o.status]])},{default:n(()=>[b(u(dt[o.status]),1)]),_:2},1032,["class"])]),e("div",ce,[a(s(L),{variant:"outline",class:"gap-1 border-stone-300 text-[9px] md:text-xs px-1 md:px-2"},{default:n(()=>[a(s(Q),{class:"w-2.5 h-2.5 md:w-3 md:h-3"}),b(" "+u(o.vote_count),1)]),_:2},1024),a(s(L),{variant:"outline",class:"gap-1 border-stone-300 text-[9px] md:text-xs px-1 md:px-2"},{default:n(()=>[a(s(O),{class:"w-2.5 h-2.5 md:w-3 md:h-3"}),b(" "+u(o.comment_count),1)]),_:2},1024)])]))),128))]))])]))])):(l(),m("div",pe,[e("div",xe,[a(s(z),{class:"w-10 h-10 text-stone-900"})]),t[25]||(t[25]=e("h3",{class:"font-display font-bold text-2xl mb-2 text-stone-900 uppercase"},"Halo, penikmat karya!",-1)),t[26]||(t[26]=e("p",{class:"text-stone-600 mb-8 font-medium max-w-sm mx-auto"},"Jelajahi karya-karya siswa di halaman utama atau atur koleksi favoritmu.",-1)),e("div",he,[a(s(g),{class:"bg-stone-900 text-white border-2 border-black shadow-brutal hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] h-12 px-6",onClick:t[4]||(t[4]=o=>s(k).push("/"))},{default:n(()=>[...t[23]||(t[23]=[b(" Cari Karya ",-1)])]),_:1}),a(s(g),{variant:"outline",class:"bg-white text-stone-900 border-2 border-black shadow-brutal hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] h-12 px-6",onClick:t[5]||(t[5]=o=>s(k).push("/collections"))},{default:n(()=>[...t[24]||(t[24]=[b(" Lihat Koleksi ",-1)])]),_:1})])]))])):w("",!0),f.value==="settings"?(l(),m("div",fe,[e("div",ve,[t[31]||(t[31]=e("div",{class:"absolute top-0 right-0 w-4 h-4 bg-brand-teal border-l-2 border-b-2 border-black"},null,-1)),e("h3",we,[a(s(z),{class:"w-5 h-5"}),t[27]||(t[27]=b(" Informasi Dasar ",-1))]),e("div",ge,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-[10px] md:text-sm font-bold uppercase tracking-wide text-stone-900 mb-2"},"Nama Tampilan",-1)),a(s(V),{modelValue:P.value,"onUpdate:modelValue":t[6]||(t[6]=o=>P.value=o),class:"border-2 border-black shadow-brutal-xs md:shadow-brutal-sm focus:shadow-none focus:translate-x-[1px] focus:translate-y-[1px] transition-all h-10 md:h-12 text-sm md:text-lg font-medium"},null,8,["modelValue"])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-[10px] md:text-sm font-bold uppercase tracking-wide text-stone-900 mb-2"},"Email",-1)),a(s(V),{value:s(c)?.email,disabled:"",class:"bg-stone-100 border-2 border-stone-300 text-stone-500 h-10 md:h-12 cursor-not-allowed font-mono text-xs md:text-sm"},null,8,["value"])]),e("div",ye,[a(s(g),{onClick:mt,disabled:T.value,class:"w-full sm:w-auto bg-stone-900 text-white border-2 border-black shadow-brutal hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] h-10 md:h-12 px-6 md:px-8 font-bold uppercase tracking-widest text-[10px] md:text-xs"},{default:n(()=>[T.value?(l(),h(s(q),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):w("",!0),t[30]||(t[30]=b(" Simpan Profil ",-1))]),_:1},8,["disabled"])])])]),e("div",ke,[t[37]||(t[37]=e("div",{class:"absolute top-0 right-0 w-4 h-4 bg-brand-red border-l-2 border-b-2 border-black"},null,-1)),e("h3",_e,[a(s(W),{class:"w-5 h-5"}),t[32]||(t[32]=b(" Keamanan Akun ",-1))]),e("div",Pe,[e("div",null,[t[33]||(t[33]=e("label",{class:"block text-[10px] md:text-sm font-bold uppercase tracking-wide text-stone-900 mb-2"},"Password Saat Ini",-1)),e("div",je,[a(s(V),{modelValue:F.value,"onUpdate:modelValue":t[7]||(t[7]=o=>F.value=o),type:D.value?"text":"password",class:"border-2 border-black shadow-brutal-xs md:shadow-brutal-sm h-10 md:h-12 pr-12 text-sm",placeholder:"••••••••"},null,8,["modelValue","type"]),e("button",{type:"button",onClick:t[8]||(t[8]=o=>D.value=!D.value),class:"absolute right-4 top-1/2 -translate-y-1/2 text-stone-400 hover:text-stone-900"},[D.value?(l(),h(s(Ct),{key:1,class:"w-4 h-4 md:w-5 md:h-5"})):(l(),h(s(jt),{key:0,class:"w-4 h-4 md:w-5 md:h-5"}))])])]),e("div",Ce,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-[10px] md:text-sm font-bold uppercase tracking-wide text-stone-900 mb-2"},"Password Baru",-1)),a(s(V),{modelValue:j.value,"onUpdate:modelValue":t[9]||(t[9]=o=>j.value=o),type:st.value?"text":"password",class:"border-2 border-black shadow-brutal-xs md:shadow-brutal-sm h-10 md:h-12 text-sm",placeholder:"••••••••"},null,8,["modelValue","type"])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-[10px] md:text-sm font-bold uppercase tracking-wide text-stone-900 mb-2"},"Konfirmasi",-1)),a(s(V),{modelValue:$.value,"onUpdate:modelValue":t[10]||(t[10]=o=>$.value=o),type:at.value?"text":"password",class:"border-2 border-black shadow-brutal-xs md:shadow-brutal-sm h-10 md:h-12 text-sm",placeholder:"••••••••"},null,8,["modelValue","type"])])]),e("div",Ve,[a(s(g),{variant:"outline",onClick:bt,disabled:U.value,class:"w-full sm:w-auto bg-white text-stone-900 border-2 border-black shadow-brutal hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] h-10 md:h-12 px-6 md:px-8 font-bold uppercase tracking-widest text-[10px] md:text-xs"},{default:n(()=>[U.value?(l(),h(s(q),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):w("",!0),t[36]||(t[36]=b(" Perbarui Kata Sandi ",-1))]),_:1},8,["disabled"])])])])])):w("",!0)])]),_:1}))}},Se=ht(Fe,[["__scopeId","data-v-ae817feb"]]);export{Se as default};
