import{A as F,V as L}from"./SidebarAdmin-QADB59DV.js";import{_ as N}from"./PageHeader-CP7TjvgY.js";import{ak as D,g as u,D as x,k as t,aH as K,Q as G,o,f as H,h as a,a as s,n as q,r as m,w as l,B as r,U as J,A as T,aA as A,aw as O,aB as j,E as g,z as $,L as B,F as P,q as Q,G as R,ac as S,$ as V,a8 as X,c as w,t as M,C as _,O as Y,R as Z,H as I}from"./index-CtvPx6GS.js";import{R as W}from"./refresh-cw-Y7NK4UCN.js";import"./shield-sTgBLMjY.js";import"./file-text-Baqh5H0I.js";import"./settings-CH5f6Q4j.js";const z=D({__name:"CardDescription",props:{class:{}},setup(k){const p=k;return(v,d)=>(o(),u("p",{class:x(t(K)("text-sm text-stone-600 font-body",p.class))},[G(v.$slots,"default")],2))}}),ee={class:"min-h-screen bg-stone-100"},se={class:"flex items-center gap-2 text-xs font-mono uppercase tracking-wider mb-4"},te={class:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8"},ae={class:"flex items-center justify-between"},ne={class:"flex items-center gap-2"},le={key:0,class:"p-8 flex justify-center"},re={key:1,class:"p-8 text-center text-stone-500 italic"},oe={key:2,class:"divide-y divide-stone-200"},ie={class:"w-10 h-14 bg-stone-200 border border-stone-800 flex-shrink-0 overflow-hidden"},de=["src"],ue={class:"flex-1 min-w-0"},ce={class:"font-bold text-sm truncate"},be={class:"text-xs text-stone-500"},fe={class:"flex items-center gap-2 text-red-700"},me={class:"flex flex-col gap-4"},pe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},ve={class:"relative bg-white border-2 border-black shadow-brutal w-full max-w-md animate-in fade-in zoom-in duration-200"},ge={class:"flex items-center justify-between px-6 py-4 border-b-2 border-black bg-red-50"},_e={class:"flex items-center gap-2 text-red-700"},xe=["disabled"],he={class:"p-6"},we={class:"flex gap-3 justify-end"},Be={__name:"TrendingManager",setup(k){const{showToast:p}=I(),v=m(!1),d=m(!1),b=m([]),f=m(!0),c=m(!1),h=async()=>{f.value=!0;try{const n=await M.get("/api/votes/trending",{params:{limit:10,period:"all"}});Array.isArray(n)?b.value=n:(n?.data&&Array.isArray(n.data)||n?.success&&Array.isArray(n.data))&&(b.value=n.data)}catch(n){console.error("Failed to fetch trending:",n)}finally{f.value=!1}},U=()=>{c.value=!0},E=async()=>{d.value=!0;try{const n=await M.delete("/api/votes/reset");if(n?.success||n?.message?.toLowerCase().includes("success"))p("Semua voting telah direset."),c.value=!1,await h();else throw new Error(n?.message||"Gagal mereset voting")}catch(n){console.error("Reset votes error:",n);const e=n.message||"Terjadi kesalahan saat mereset voting.";p(e,"error")}finally{d.value=!1}};return H(()=>{h()}),(n,e)=>{const y=J("router-link");return o(),u("div",ee,[a(F,{"onUpdate:collapsed":e[0]||(e[0]=i=>v.value=i)}),s("main",{class:x(["p-4 md:p-8 transition-all duration-300",v.value?"ml-14":"ml-56"])},[s("nav",se,[a(y,{to:"/",class:"text-brand-teal hover:underline"},{default:l(()=>[...e[4]||(e[4]=[r("Beranda",-1)])]),_:1}),e[7]||(e[7]=s("span",{class:"text-stone-400"},"/",-1)),a(y,{to:"/admin",class:"text-stone-600 hover:underline"},{default:l(()=>[...e[5]||(e[5]=[r("Administrasi",-1)])]),_:1}),e[8]||(e[8]=s("span",{class:"text-stone-400"},"/",-1)),a(t(T),{variant:"outline",class:"bg-blue-100 text-blue-700 border-blue-300"},{default:l(()=>[...e[6]||(e[6]=[r("Manajer Trending",-1)])]),_:1})]),a(N,{title:"Manajemen Trending",description:"Kelola sistem trending dan reset status apresiasi karya.",icon:t(L),"icon-color":"bg-blue-500"},null,8,["icon"]),s("div",te,[a(t(R),{class:"border-2 border-black shadow-brutal h-fit"},{default:l(()=>[a(t(A),{class:"bg-stone-50 border-b-2 border-black"},{default:l(()=>[s("div",ae,[s("div",ne,[a(t(O),{class:"w-5 h-5"}),a(t(j),null,{default:l(()=>[...e[9]||(e[9]=[r("Status Peringkat Trending",-1)])]),_:1})]),a(t(g),{variant:"ghost",size:"icon",class:"h-8 w-8 hover:bg-stone-200",onClick:h,disabled:f.value},{default:l(()=>[a(t(W),{class:x(["w-4 h-4",{"animate-spin":f.value}])},null,8,["class"])]),_:1},8,["disabled"])]),a(t(z),null,{default:l(()=>[...e[10]||(e[10]=[r(" Top 10 karya dengan apresiasi terbanyak saat ini. ",-1)])]),_:1})]),_:1}),a(t($),{class:"p-0"},{default:l(()=>[f.value?(o(),u("div",le,[a(t(B),{class:"w-8 h-8 animate-spin text-stone-400"})])):b.value.length===0?(o(),u("div",re," Belum ada data trending. ")):(o(),u("div",oe,[(o(!0),u(P,null,Q(b.value,(i,C)=>(o(),u("div",{key:i.film_id,class:"flex items-center gap-4 p-4 hover:bg-stone-50 transition-colors"},[s("div",{class:x(["w-8 h-8 flex items-center justify-center font-bold font-mono border-2 border-black shadow-brutal-sm",C<3?"bg-yellow-400":"bg-white"])}," #"+_(C+1),3),s("div",ie,[i.gambar_poster?(o(),u("img",{key:0,src:t(Y)(i.gambar_poster),class:"w-full h-full object-cover"},null,8,de)):(o(),w(t(Z),{key:1,class:"w-full h-full p-2 text-stone-400"}))]),s("div",ue,[s("h4",ce,_(i.judul),1),s("p",be,_(i.category?.nama_kategori||"-"),1)]),a(t(T),{variant:"secondary",class:"font-mono bg-stone-800 text-white border-none"},{default:l(()=>[r(_(i.vote_count)+" Suara ",1)]),_:2},1024)]))),128))]))]),_:1})]),_:1}),a(t(R),{class:"border-2 border-red-200 shadow-brutal h-fit"},{default:l(()=>[a(t(A),{class:"bg-red-50 border-b border-red-100"},{default:l(()=>[s("div",fe,[a(t(S),{class:"w-5 h-5"}),a(t(j),null,{default:l(()=>[...e[11]||(e[11]=[r("Zona Bahaya",-1)])]),_:1})]),a(t(z),{class:"text-red-600"},{default:l(()=>[...e[12]||(e[12]=[r(" Tindakan di bawah ini bersifat destruktif dan tidak dapat dibatalkan. ",-1)])]),_:1})]),_:1}),a(t($),{class:"p-6"},{default:l(()=>[s("div",me,[e[14]||(e[14]=s("div",null,[s("h3",{class:"font-bold text-stone-900 mb-1"},"Reset Statistik Trending"),s("p",{class:"text-sm text-stone-500"}," Menghapus seluruh data apresiasi dari database. Jumlah suara pada semua karya akan kembali menjadi 0. ")],-1)),a(t(g),{variant:"destructive",class:"w-full sm:w-auto bg-red-600 hover:bg-red-700 border-2 border-black shadow-brutal hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-brutal-sm transition-all justify-center",onClick:U,disabled:d.value},{default:l(()=>[a(t(V),{class:"w-4 h-4 mr-2"}),e[13]||(e[13]=r(" Reset Trending ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1})])],2),c.value?(o(),u("div",pe,[s("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e[1]||(e[1]=i=>d.value?null:c.value=!1)}),s("div",ve,[s("div",ge,[s("div",_e,[a(t(S),{class:"w-5 h-5"}),e[15]||(e[15]=s("h2",{class:"font-bold text-lg"},"Konfirmasi Reset",-1))]),s("button",{onClick:e[2]||(e[2]=i=>c.value=!1),class:"p-1 hover:bg-red-100 rounded transition-colors",disabled:d.value},[a(t(X),{class:"w-5 h-5"})],8,xe)]),s("div",he,[e[18]||(e[18]=s("p",{class:"text-stone-700 mb-6 leading-relaxed"},[r(" Apakah Anda yakin ingin mereset "),s("strong",null,"SEMUA"),r(" data trending? "),s("br"),s("br"),s("span",{class:"text-red-600 font-bold text-sm bg-red-50 px-2 py-1 border border-red-200 rounded"}," Tindakan ini tidak dapat dibatalkan! ")],-1)),s("div",we,[a(t(g),{type:"button",variant:"outline",onClick:e[3]||(e[3]=i=>c.value=!1),disabled:d.value},{default:l(()=>[...e[16]||(e[16]=[r(" Batal ",-1)])]),_:1},8,["disabled"]),a(t(g),{type:"button",class:"bg-red-600 hover:bg-red-700 text-white gap-2",onClick:E,disabled:d.value},{default:l(()=>[d.value?(o(),w(t(B),{key:0,class:"w-4 h-4 animate-spin"})):(o(),w(t(V),{key:1,class:"w-4 h-4"})),e[17]||(e[17]=r(" Ya, Reset Semua ",-1))]),_:1},8,["disabled"])])])])])):q("",!0)])}}};export{Be as default};
